[{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Detach a Policy Set to a workspace in Terraform Cloud","Label":"Detach a Policy Set from workspaces ","Name":"DetachaPolicySetfromworkspaces","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The API call can be made to Intersight or an external endpoint added as Target. Target should be in claimed or connected state. Please refer Supported Endpoints section in the Web API request end user documentation for the list of Intersight Targets on which Web API task can be invoked. An empty value for this input indicates that the API call is made to Intersight.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"External Target","Name":"Target","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"SupportedObjects":["asset.Target"]}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The ID of the policy set to attach to workspaces","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Policy ID","Name":"policyID","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"ArrayItemType":{"ObjectType":"workflow.PrimitiveArrayItem","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"A list of resource identifier (ID)  that defines the workspaces the policy set will be attached to.","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspaces ID","Max":100,"Min":1,"Name":"workspacesID","ObjectType":"workflow.ArrayDataType","Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The ID of the newly created policy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Policy ID","Name":"policyID","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The URL of the newly created Policy","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Policy URL Link","Name":"policyURL","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}],"RetryCount":3,"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"user","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.WorkflowDefinition","DefaultVersion":true,"InputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The ID of the policy set to detach from workspaces","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Policy Set ID","Name":"policyID","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"ArrayItemType":{"ObjectType":"workflow.PrimitiveArrayItem","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The ID of the workspace to remove from the Policy Set","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Max":100,"Min":1,"Name":"workspacesID","ObjectType":"workflow.ArrayDataType","Required":true}],"InputParameterSet":[],"Label":"Demo - Detach a workspace from a Policy Set","Name":"Demo-DetachaworkspacefromaPolicySet","ObjectType":"workflow.WorkflowDefinition","OutputDefinition":[],"Properties":{"EnableDebug":true,"ExternalMeta":true,"ObjectType":"workflow.WorkflowProperties","SupportStatus":"Supported"},"SharedScope":"user","Tasks":[{"Name":"SuccessEndTask","ObjectType":"workflow.SuccessEndTask"},{"Name":"FailureEndTask","ObjectType":"workflow.FailureEndTask"},{"Name":"StartTask","NextTask":"DetachaPolicySetfromworkspaces1","ObjectType":"workflow.StartTask"},{"CatalogMoid":"user","Description":"Detach a Policy Set to a workspace in Terraform Cloud","InputParameters":{"policyID":"${workflow.input.policyID}","workspacesID":"${workflow.input.workspacesID}"},"Label":"Detach a Policy Set from workspaces ","Name":"DetachaPolicySetfromworkspaces1","ObjectType":"workflow.WorkerTask","OnSuccess":"SuccessEndTask","TaskDefinitionName":"DetachaPolicySetfromworkspaces","Version":1}],"UiInputFilters":[],"UiRenderingData":{"Positions":[{"Name":"StartTask","X":263.5,"Y":34.5},{"Name":"SuccessEndTask","X":418,"Y":32},{"Name":"FailureEndTask","X":560,"Y":32},{"Name":"DetachaPolicySetfromworkspaces1","X":178.5,"Y":106}]},"VariableDefinition":[],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/WorkflowDefinitions","Verb":"POST"},{"Body":{"Batch":[{"Body":"{\n  \"data\": [\n    {{range $i, $e := .global.task.input.workspacesID}}\n      {{if $i}},\n      {{end}}{\"id\":\"{{$e}}\", \"type\":\"workspace\"}{{end}}\n  ]\n}  ","ContentType":"json","Description":"Detach the Policy Set from workspaces in Terraform cloud","EndpointRequestType":"Internal","Headers":{"Content-Type":["application/vnd.api+json"]},"Label":"Detach the Policy Set from workspaces","Method":"DELETE","Name":"InvokeGenericWebApi1","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{eq .global.InvokeGenericWebApi1.output.HttpStatusCode 204}}","Message":"Successfully detached the workspace(s) from a policy set","Name":"204","Type":"Success"},{"Condition":"{{eq .global.InvokeGenericWebApi1.output.HttpStatusCode 404}}","Message":"Policy set not found or user unauthorized to perform action","Name":"404","Type":"TerminalError"},{"Condition":"{{eq .global.InvokeGenericWebApi1.output.HttpStatusCode 422}}","Message":"Malformed request body (missing attributes, wrong types, etc.)","Name":"422","Type":"TerminalError"},{"Condition":"{{gt .global.InvokeGenericWebApi1.output.HttpStatusCode 300}}","Message":"Generic failure {{.global.InvokeGenericWebApi1.output.HttpStatusMsg}}","Name":"Generic Faliure","Type":"TerminalError"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"policyID","ObjectType":"content.Parameter","Path":"$.data.id","Secure":false,"Type":"string"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"policyLink","ObjectType":"content.Parameter","Path":"$.data.links.self","Secure":false,"Type":"string"}],"Types":[]},"TargetType":"Endpoint","Url":"api/v2/policy-sets/{{.global.task.input.policyID}}/relationships/workspaces"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"Detach a Policy Set to a workspace in Terraform Cloud","Name":"Detach a Policy Set from workspaces ","ObjectType":"workflow.BatchApiExecutor","Output":{"policyID":"{{.global.InvokeGenericWebApi1.output.policyID}}","policyURL":"{{.global.InvokeGenericWebApi1.output.policyLink}}"},"SharedScope":"user","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"DetachaPolicySetfromworkspaces\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"}]